# 操作系统概述

## 目标和作用

### 1. 定义

* 操作系统是一组用于控制和管理计算机系统硬件和软件资源，合理的对各类作业进行调度，以方便用户使用的**程序集合**

### 2. 目标

* 方便性
* 有效性
* 可扩充性
* 开放性

### 3. 基本特征

* #### **并发**

  指两个或者多个活动在同一给定的时间间隔中进行

* #### **共享**（

  分为**互斥共享方式**和**同时访问方式**

  计算机系统中的资源背多个进程所共用

* #### **异步**

  进程以不可预知的速度向前推及

* #### **虚拟**

  把一个物理上的实体变为若干个逻辑上的对应物

##### 💠最基本：

并发和共享（互为存在关系

### 4. 主要功能

* #### 处理机管理

  * 进程控制、进程同步、进程通信、死锁处理、处理机调度

* #### 存储器管理

  * 内存分配、地址映射、内存保护与共享、内存扩充

* #### 文件管理

  * 文件存储空间的管理、目录管理、文件读写管理和保护

* #### 设备管理

  * 缓冲管理、设备分配、设备处理、虚拟设备
  
* #### 用户接口

  * 命令接口、程序接口、图形接口、


### 5. 发展

* #### 手工操作阶段

  缺点：人机速度矛盾

* #### 脱机IO方式

  优点：减少CPU空闲时间、提高IO速度

* #### 批处理阶段

  * **单道批处理阶段**

    优点：缓解人机速度矛盾

    缺点：系统资源利用率仍然低

  * **多道批处理阶段（操作系统正式诞生**

    优点：多道程序并发执行，资源利用率高

    缺点：资源利用率高、系统吞吐量大、平均周转时间长、无交互性

* #### 分时操作系统（可交互

  优点：提供人机交互

  缺点：不能优先处理紧急事务

  关键问题：及时接收、及时处理

* #### 实时操作系统（可插队

  优点：可优先处理紧急事务

  * **硬实时系统**

    必须在被控制对象规定时间内完成（火箭发射）

  * **软实时系统**

    松一些（订票）

## 概念

### 1. 两种指令

* #### 特权指令

  不允许用户程序使用，只允许操作系统使用。*如IO指令、中断指令*

* #### 非特权指令

  普通运算指令

### 2. 两种程序

* #### 内核程序

  系统的管理者，可执行一切指令，运行在<u>核心态</u>

* #### 应用程序

  普通用户程序，只能执行非特权指令，运行在<u>用户态</u>

### 3. 处理机状态

* #### 用户态

  即目态，CPU只能执行非特权指令

* #### 核心态

  即管态、内核态，可以执行所有指令

* **用户态—>核心态**：通过中断（用<u>硬件</u>完成）

* **核心态—>用户态**：特权指令psw的标志位，0用户态，1核心态

### 4. 中断和异常

* #### 内中断（异常）

  自愿中断——指令中断

  强迫中断——硬件中断、软件中断（error）

* #### 外中断（中断）

  外设请求、人工干预（如打印机）

### 5. 系统调用

系统给程序员提供的唯一接口，在**用户态**发生，**核心态**处理

### 6. 体系结构

* 大内核

* #### 微内核

  * 基本功能：进程管理、存储器管理、进程间通信、低级IO功能


------

# 第二章 进程

## 进程概念

### 1. 程序的顺序执行

* 顺序性、封闭性、可再现性

### 2. 前驱图DAG

* 一个有向无循环图

### 3. 程序的并发执行

* 间断性、失去封闭性、不可再现性

### 4. 定义

* 是计算机中程序关于某数据集合上的一次运行活动，是<u>系统进行资源分配和调度的基本单位</u>。

### 5. 组成

* #### PCB：

  保存进程运行期间相关的数据，是进程存在的**唯一标志**

* #### 程序段：

  能被进程调度到CPU的代码

* #### 数据段：

  存放数据

### 6. 进程的状态

* #### 类别

  * **运行态**：正在占用CPU
  * **就绪态**：已处于准备运行的状态，只需得到处理机即可运行
  * **阻塞态**：由于等待某一事件不能享用CPU
  * **创建状态**：正在被创建
  * **结束状态**：正在从系统消失

* #### 状态变化

  <img src="C:\Users\仵六七\AppData\Roaming\Typora\typora-user-images\image-20230608172329037.png" alt="image-20230608172329037" style="zoom:50%;" />

  **就绪—>运行**：被调度，获得处理机资源

  **运行—>就绪**：时间片用完或在可剥夺系统中有更高级进程进入

  **运行—>阻塞**：需要的某一资源还没准备好

  **阻塞—>就绪**：进程等待的事件到来时

### 7. 线程

* #### 目的

  为了更好的使用多道程序并发执行，提高资源利用率和系统吞吐量

  💠**资源**：是程序执行的最小单位，基本不拥有任何系统特点

> **进程和程序的区别**：
>
> 1. 进程是动态的，程序是静态的，程序是有序代码的集合；
> 2. 进程是程序的执行；
> 3. 进程是暂时的，程序是永久的，进程是一个状态变化的过程，程序可长久保存；
> 4. 进程的组成包括程序、数据和进程控制块；
> 5. 通过多次执行，一个程序可对应多个进程。

## 处理机调度

### 1. 概念

是对处理机进行分配，即从就绪队列中按照给定的算法，选择一个进程并将处理机分配给它运行，以**实现进程并发执行**

### 2. 分类

* 高级调度（作业调度）
* 中级调度（内存对换）
* 低级调度（进程调度）

### 3. 调度方式

* 剥夺式
* 非剥夺式

### 4. 调度准则

* CPU利用率
* 系统吞吐量
* 周转时间
* 等待时间
* 响应时间

### 5. 算法

* 先来先服务（FCFS)
* 短作业优先
* 优先级调度算法
* 高响应比优先调度算法
* 时间片轮转
* 多级反馈队列调度算法

> **响应比**：
>
> （等待时间+要求服务时间）/要求服务时间

## 进程同步

### 1. 制约关系

* 同步制约关系（直接制约关系）
* 互斥制约关系（间接制约关系）

### 2. 临界资源

* 一次只允许一个进程使用的资源

### 3. 临界区

* 在每个进程中访问临界资源的那段程序

### 4. 临界区互斥

* **原则**
  * 空闲让进：一次仅允许一个进程进入空闲临界区
  * 忙则等待：如果已有进程进入自己的临界区，其他进程必须等待
  * 有限等待：进入临界区的进程要在有限时间内退出
  * 让权等待：如果进程不能进入自己的临界区，则应让出CPU，避免出现“忙等”现象
* 基本方法：
  * 信号量
  * 利用PV操作实现互斥

## 死锁

### 1. 原因：

非剥夺资源的竞争和进程的不恰当推进顺序

### 2. 定义：

多个进程因竞争资源而造成的一种僵局，没有外力将无法推进

### 3. 解决方法

* 预防死锁：破环互斥条件、破坏不剥夺条件、破坏请求和保持条件、破坏循环等待条件
* 避免死锁：银行家算法
* 检测死锁：利用死锁定理
* 解除死锁：进程回退法